var y=Object.defineProperty;var d=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var m=(a,e,t)=>e in a?y(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,g=(a,e)=>{for(var t in e||(e={}))_.call(e,t)&&m(a,t,e[t]);if(d)for(var t of d(e))z.call(e,t)&&m(a,t,e[t]);return a};import{r as l,n,R as c,a as $,B as x,b as f,c as C,d as b,T as w,e as R,C as S,f as N,E as T}from"./vendor.7a891135.js";const A=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};A();const I="react-ant-abstract-curd";class p extends l.exports.Component{constructor(e){super(e);this.engineType="local",this.resources="users",this.rowKey="id",this.size="small",this.bordered=!0,this.current={item:null,index:-1},this.module="modules",this.action="index",this.pagination={page:"page",size:"size",total:"total"},this.route=(r,s)=>{const i=`/${this.module}/${this.resources}/${r}`,o=s?"replace":"push";this.routeService[o](i)},this.add=()=>{this.routeService.push(`/${this.module}/${this.resources}/add`)},this.edit=()=>{this.routeService.push(`/${this.module}/${this.resources}/edit/${this.id}`)},this.del=()=>{const r=n.mix(null,this.current.item,this.options);this.apiService[`${this.resources}_destroy`](r).then(()=>{this.refresh()})},this.handleTableChange=r=>{const{current:s,pageSize:i}=r,{page:o,size:u}=this.pagination,h={[o]:s,[u]:i};this.page=s,this.pageSize=i,this.setState(h,()=>{this.load(h)})};const{total:t}=this.pagination;this.lastQs=this.qs,this.state=n.mix(null,this.initialState(),{loading:!1,columns:this.columns,data:[],[t]:0}),this.init()}get options(){return{}}get page(){const e=n.get(n[`$${this.engineType}`],`curd__pagination.${this.resources}.page`);return this._page||e||1}set page(e){this._page=e,n[`$${this.engineType}`]={[`curd__pagination.${this.resources}.page`]:e}}get pageSize(){const e=n.get(n[`$${this.engineType}`],`curd__pagination.${this.resources}.pageSize`);return this._pageSize||e||10}set pageSize(e){this._pageSize=e,n[`$${this.engineType}`]={[`curd__pagination.${this.resources}.pageSize`]:e}}get id(){return n.get(this.current,`item.${this.rowKey}`)}get fields(){return[]}get actions(){return{title:"\u64CD\u4F5C",width:90,render:()=>c.createElement("span",{className:"mr-5_ mr_ is-actions"},c.createElement("a",{onClick:this.edit},"\u7F16\u8F91"),c.createElement($,{onClick:this.del},"\u5220\u9664"))}}get columns(){return this.actions?this.fields.concat(this.actions):this.fields}get extraView(){return c.createElement("div",{className:"is-extra"},c.createElement(x,{size:"small",onClick:this.add,className:"mr-5_ mr_"},c.createElement(f,{value:"addition",size:14}),c.createElement("span",null,"\u65B0\u589E")))}get params(){return n.get(this.props,"match.params")}get qs(){const e=location.hash.slice(1);if(!e)return{};const[t,r]=e.split("?");return C(r)}initialState(){return null}setResponse(e){return e}init(){}initCache(){const{page:e,size:t,total:r}=this.pagination;this.state=Object.assign(this.state,{[e]:this.page,[t]:this.pageSize,[r]:0})}componentDidMount(){const{page:e}=this.pagination;this.attachEvents(),this.initCache(),this.load({[e]:this.state[e]}),setTimeout(()=>{n.set(this.routeService,"current",this.props)},0)}shouldComponentUpdate(){return b(this.qs,this.lastQs)||(this.lastQs=this.qs,this.refresh()),!0}componentWillUnmount(){this.detachEvents()}attachEvents(){this.refreshEvent=this.eventService.on(`${this.resources}.${this.action}.refresh`,()=>{this.refresh()})}detachEvents(){this.refreshEvent&&this.refreshEvent.destroy()}refresh(){const{page:e,size:t}=this.pagination;this.load({[e]:this.state[e],[t]:this.pageSize})}load(e,t){const r=t||this.action||"index",{size:s}=this.pagination,i=n.mix({[s]:this.pageSize},e,this.options);this.setState({loading:!0}),this.apiService[`${this.resources}_${r}`](i).then(o=>{const{rows:u,total:h}=this.setResponse(o);this.setState({data:u,total:h,loading:!1})})}table(e){const t=e||{},{columns:r,data:s,total:i,loading:o}=this.state,{page:u,size:h}=this.pagination;return c.createElement(w,g({loading:o,size:this.size,bordered:this.bordered,columns:r,dataSource:s,onChange:this.handleTableChange,rowKey:this.rowKey,onRow:(E,v)=>({onMouseEnter:()=>{this.current={index:v,item:E}}}),pagination:{showSizeChanger:!0,total:i,pageSize:this.state[h],current:this.state[u]}},t))}empty(){return c.createElement(R,{centered:!0,title:"\u6682\u65E0\u6570\u636E"})}view(){const{data:e}=this.state;return c.createElement(S,{title:"\u5217\u8868"},e.length?this.table():this.empty())}render(){throw new Error("Render method must be implement!")}}p.displayName=I;p.version="__VERSION__";p.defaultProps={};class q{static repos_index(e){var t=n.param(e,"https://jsonplaceholder.typicode.com/posts");return fetch(t).then(r=>r.json())}static repos_destroy(e){return new Promise(t=>{console.log("call destroy api",e),t(e)})}}class L{static push(e){console.log("push to:",e)}}class O extends p{constructor(){super(...arguments);this.apiService=q,this.routeService=L,this.eventService=n.mix(this,T),this.resources="repos",this.pagination={page:"page",size:"per_page",total:"total"}}get fields(){return[n.antColumn("ID","id"),n.antColumn("title","title"),n.antColumn("body","body",e=>String(e)),n.antColumn("uid","userId")]}setResponse(e){return{rows:e,total:100}}get titleView(){return l.exports.createElement("span",{className:"mr-5_ mr_"},l.exports.createElement(f,{value:"date"}),l.exports.createElement("span",null,"\u5217\u8868\u7BA1\u7406"))}render(){return l.exports.createElement(S,{title:this.titleView,className:"m10",extra:this.extraView},this.table())}}N.exports.render(l.exports.createElement(O,null),document.getElementById("root"));
