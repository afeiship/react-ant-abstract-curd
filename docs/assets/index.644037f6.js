var z=Object.defineProperty;var S=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var y=(n,e,s)=>e in n?z(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,g=(n,e)=>{for(var s in e||(e={}))C.call(e,s)&&y(n,s,e[s]);if(S)for(var s of S(e))w.call(e,s)&&y(n,s,e[s]);return n};import{r as c,N as b,n as o,m as x,d as _,R as a,a as $,b as R,B as v,c as f,e as k,f as N,T as O,g as A,C as E,h as I,E as q}from"./vendor.8d30b448.js";const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}};B();const F="react-ant-abstract-curd";class d extends c.exports.Component{constructor(e){super(e);this.urlOperator=new b({type:"hash"}),this.resources="users",this.rowKey="id",this.size="small",this.bordered=!0,this.current={item:null,index:-1},this.module="modules",this.action="index",this.searchable=!1,this.pagination={page:"page",size:"size",total:"total"},this.route=(r,t)=>{const i=`/${this.module}/${this.resources}/${r}`,h=t?"replace":"push";this.routeService[h](i)},this.add=()=>{this.routeService.push(`/${this.module}/${this.resources}/add`)},this.edit=()=>{this.routeService.push(`/${this.module}/${this.resources}/edit/${this.id}`)},this.del=()=>{const r=o.mix(null,this.current.item,this.options);this.apiService[`${this.resources}_destroy`](r).then(()=>this.refresh())},this.update=r=>{const t=g({id:this.id},r);this.apiService[`${this.resources}_update`](t).then(()=>x.success("\u64CD\u4F5C\u6210\u529F"))},this.refresh=()=>{const{page:r,size:t}=this.pagination;this.load({[r]:this.state[r],[t]:this.pageSize})},this.forceRefresh=()=>{this.keywords="",this.handleTableChange({current:1,pageSize:this.pageSize})},this.load=_((r,t)=>{const i=t||this.action||"index",{size:h}=this.pagination,u=o.mix({[h]:this.pageSize},r,this.options);this.setState({loading:!0}),this.apiService[`${this.resources}_${i}`](u).then(l=>{const{rows:p,total:m}=this.setResponse(l);this.setState({data:p,total:m,loading:!1})})}),this.handleQuery=r=>{const{value:t}=r.target;this.keywords=t,this.handleTableChange({current:1,pageSize:this.pageSize})},this.handleTableChange=r=>{const{current:t,pageSize:i}=r,{page:h,size:u}=this.pagination,l={[h]:t,[u]:i};this.page=t,this.pageSize=i,this.setState(l,()=>{this.load(l)})};const{total:s}=this.pagination;this.lastQs=this.qs,this.state=o.mix(null,this.initialState(),{loading:!1,columns:this.columns,keywords:this.keywords,data:[],[s]:0}),this.init()}get options(){return{}}get keywords(){const{keywords:e}=this.qs;return e||""}set keywords(e){const s={keywords:e};location.href=this.urlOperator.update(s),this.setState(s)}get page(){const{page:e}=this.qs;return e||1}set page(e){location.href=this.urlOperator.update({page:e})}get pageSize(){const{size:e}=this.qs;return e||10}set pageSize(e){location.href=this.urlOperator.update({size:e})}get id(){return o.get(this.current,`item.${this.rowKey}`)}get fields(){return[]}get actions(){return{title:"\u64CD\u4F5C",width:90,render:()=>a.createElement("span",{className:"mr-5_ mr_ is-actions"},a.createElement("a",{onClick:this.edit},"\u7F16\u8F91"),a.createElement($,{onClick:this.del},"\u5220\u9664"))}}get columns(){return this.actions?this.fields.concat(this.actions):this.fields}get extraView(){return a.createElement("div",{className:"mr-5_ is-extra"},this.searchable&&a.createElement(R,{placeholder:`\u6309title\u641C\u7D22${this.resources}`,allowClear:!0,autoFocus:!0,size:"small",value:this.state.keywords,enterButton:!0,onChange:e=>this.setState({keywords:e.target.value}),onSearch:this.handleQuery}),a.createElement(v,{size:"small",onClick:this.forceRefresh,className:"mr-5_ mr_"},a.createElement(f,{value:"refresh",size:14}),a.createElement("span",null,"\u5237\u65B0")),a.createElement(v,{size:"small",onClick:this.add,className:"mr-5_ mr_"},a.createElement(f,{value:"addition",size:14}),a.createElement("span",null,"\u65B0\u589E")))}get params(){return o.get(this.props,"match.params")}get qs(){const e=location.hash.slice(1);if(!e)return{};const[s,r]=e.split("?");return k(r)}initialState(){return null}setResponse(e){return e}init(){}initCache(){const{page:e,size:s,total:r}=this.pagination;this.state=Object.assign(this.state,{[e]:this.page,[s]:this.pageSize,[r]:0})}componentDidMount(){const{page:e}=this.pagination;this.attachEvents(),this.initCache(),this.load({[e]:this.state[e]}),setTimeout(()=>{o.set(this.routeService,"current",this.props)},0)}shouldComponentUpdate(){return N(this.qs,this.lastQs)||(this.lastQs=this.qs,this.refresh()),!0}componentWillUnmount(){this.detachEvents()}attachEvents(){this.refreshEvent=this.eventService.on(`${this.resources}.${this.action}.refresh`,()=>{this.refresh()})}detachEvents(){this.refreshEvent&&this.refreshEvent.destroy()}table(e){const s=e||{},{columns:r,data:t,total:i,loading:h}=this.state,{page:u,size:l}=this.pagination;return a.createElement(O,g({loading:h,size:this.size,bordered:this.bordered,columns:r,dataSource:t,onChange:this.handleTableChange,rowKey:this.rowKey,onRow:(p,m)=>({onMouseEnter:()=>{this.current={index:m,item:p}}}),pagination:{showSizeChanger:!0,total:i,pageSize:parseInt(this.state[l]),current:parseInt(this.state[u])}},s))}empty(){return a.createElement(A,{centered:!0,title:"\u6682\u65E0\u6570\u636E"})}view(){const{data:e}=this.state;return a.createElement(E,{title:"\u5217\u8868"},e.length?this.table():this.empty())}render(){return null}}d.displayName=F;d.version="__VERSION__";d.defaultProps={};class T{static repos_index(e){var s=o.param(e,"https://jsonplaceholder.typicode.com/posts");return fetch(s).then(r=>r.json())}static repos_destroy(e){return new Promise(s=>{console.log("call destroy api",e),s(e)})}}class L{static push(e){console.log("push to:",e)}}class D extends d{constructor(){super(...arguments);this.apiService=T,this.routeService=L,this.eventService=o.mix(this,q),this.resources="repos",this.searchable=!0,this.pagination={page:"page",size:"per_page",total:"total"}}get fields(){return[o.antColumn("ID","id"),o.antColumn("title","title"),o.antColumn("body","body",e=>String(e)),o.antColumn("uid","userId")]}setResponse(e){return{rows:e,total:100}}get titleView(){return c.exports.createElement("span",{className:"mr-5_ mr_"},c.exports.createElement(f,{value:"date"}),c.exports.createElement("span",null,"\u5217\u8868\u7BA1\u7406"))}render(){return c.exports.createElement(E,{title:this.titleView,className:"m10 react-ant-abstract-curd",extra:this.extraView},this.table())}}I.exports.render(c.exports.createElement(D,null),document.getElementById("root"));
